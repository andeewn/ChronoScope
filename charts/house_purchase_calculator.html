<div class="chart-card">
    <h2>Husköps- & Förmögenhetskalkylator</h2>
    <p>Beräkna den totala kostnaden för ett husköp, din månadskostnad och se en prognos över din förmögenhetsutveckling.</p>

    <div class="input-grid">
        <!-- Avsnitt 1: Indata för köpet -->
        <div class="input-section">
            <h3>Köpet</h3>
            <div class="input-group">
                <label for="hpc-purchase-price">Köpeskilling (kr)</label>
                <input type="text" id="hpc-purchase-price" value="4 000 000">
            </div>
            <div class="input-group">
                <label for="hpc-loan-percentage">Bolåneandel (%)</label>
                <input type="number" id="hpc-loan-percentage" value="85">
            </div>
            <div class="input-group">
                <label for="hpc-existing-deeds">Befintliga pantbrev (kr)</label>
                <input type="text" id="hpc-existing-deeds" value="2 000 000">
            </div>
        </div>

        <!-- Avsnitt 2: Lån och Ekonomi -->
        <div class="input-section">
            <h3>Lån & Ekonomi</h3>
            <div class="input-group">
                <label for="hpc-interest-rate">Antagen ränta (%)</label>
                <input type="number" id="hpc-interest-rate" value="4.0" step="0.1">
            </div>
            <div class="input-group">
                <label for="hpc-gross-income">Hushållets bruttoårsinkomst (kr)</label>
                <input type="text" id="hpc-gross-income" value="900 000">
            </div>
        </div>

        <!-- Avsnitt 3: Driftskostnader (Dynamisk) -->
        <div class="input-section">
            <h3>Driftskostnader</h3>
            <div class="input-group">
                <label for="hpc-expenseName">Kostnadsnamn:</label>
                <input type="text" id="hpc-expenseName" placeholder="T.ex. Vatten, El, Försäkring">
            </div>
            <div class="input-group">
                <label for="hpc-expenseCost">Kostnad (kr):</label>
                <input type="text" id="hpc-expenseCost" inputmode="numeric">
            </div>
            <div class="input-group">
                <label for="hpc-expenseOccurrence">Frekvens:</label>
                <select id="hpc-expenseOccurrence">
                    <option value="monthly" selected>Månadsvis</option>
                    <option value="quarterly">Kvartalsvis</option>
                    <option value="yearly">Årsvis</option>
                    <option value="daily">Dagligen</option>
                    <option value="weekly">Veckovis</option>
                </select>
            </div>
            <button type="button" id="hpc-addExpenseBtn" style="margin-top: 10px;">Lägg till kostnad</button>
            
            <hr style="margin-top: 20px; margin-bottom: 20px;">

            <h4>Tillagda driftskostnader</h4>
            <table id="hpc-currentExpensesTable" class="results-table" style="width: 100%;">
                <thead>
                    <tr>
                        <th>Namn</th>
                        <th>Kostnad</th>
                        <th>Frekvens</th>
                        <th>Årskostnad</th>
                        <th>Åtgärd</th>
                    </tr>
                </thead>
                <tbody id="hpc-currentExpensesTableBody">
                    <!-- Fylls i av JavaScript -->
                </tbody>
            </table>
            <p style="margin-top: 10px; font-weight: bold;">Total årlig driftskostnad: <span id="hpc-total-annual-operating-cost">0 kr</span></p>
            <p style="margin-top: 5px; font-weight: bold;">Motsvarande månadskostnad: <span id="hpc-total-monthly-operating-cost">0 kr</span></p>
        </div>

        <!-- Avsnitt 4: Engångskostnader & Prognos -->
        <div class="input-section">
            <h3>Engångskostnader & Prognos</h3>
            <div class="input-group">
                <label for="hpc-inspection-cost">Överlåtelsebesiktning</label>
                <input type="number" id="hpc-inspection-cost" value="10000">
            </div>
            <div class="input-group">
                <label for="hpc-bank-fees">Bankavgifter</label>
                <input type="number" id="hpc-bank-fees" value="1500">
            </div>
            <div class="input-group">
                <label for="hpc-moving-cost">Flytt & Städ</label>
                <input type="number" id="hpc-moving-cost" value="8000">
            </div>
            <div class="input-group">
                <label for="hpc-value-increase">Antagen årlig värdeökning (%)</label>
                <input type="number" id="hpc-value-increase" value="3.0" step="0.1">
            </div>
            <div class="input-group">
                <label for="hpc-projection-years">Antal år för prognos</label>
                <input type="number" id="hpc-projection-years" value="15">
            </div>
        </div>
    </div>

    <button id="hpc-calculate-btn" class="calculate-btn">Beräkna</button>

    <div id="hpc-results" class="results-section" style="display: none;">
        <h3>Resultat</h3>
        
        <div class="results-grid">
            <div class="result-box">
                <h4>Initiala Engångskostnader</h4>
                <p><strong>Totalt initialt kassa utlägg:</strong> <span id="hpc-total-initial-outlay"></span> kr</p>
                <p><em>Varav kontantinsats:</em> <span id="hpc-down-payment"></span> kr</p>
                <p><em>Varav lagfart & pantbrev:</em> <span id="hpc-legal-costs"></span> kr</p>
                <p><em>Varav övriga avgifter:</em> <span id="hpc-other-fees"></span> kr</p>
            </div>

            <div class="result-box">
                <h4>Total Boendekostnad (Första året)</h4>
                <p><strong>Total månadskostnad:</strong> <span id="hpc-total-monthly-cost"></span> kr/mån</p>
                <p><strong>Total årskostnad:</strong> <span id="hpc-total-yearly-cost"></span> kr/år</p>
                <p>Nettoräntekostnad: <span id="hpc-net-interest-cost"></span> kr/mån</p>
                <p>Amortering (sparande): <span id="hpc-amortization-cost"></span> kr/mån</p>
                <p>Drift, avgifter, försäkring: <span id="hpc-operating-costs"></span> kr/mån</p>
                <p>Sparande till underhåll: <span id="hpc-maintenance-saving"></span> kr/mån</p>
            </div>
        </div>

        <div class="chart-container">
            <h4>Månadskostnadens Utveckling</h4>
            <canvas id="hpc-cost-breakdown-chart"></canvas>
        </div>

        <div class="chart-container">
            <h4>Förmögenhetsprognos</h4>
            <canvas id="hpc-wealth-chart"></canvas>
        </div>

        <div class="table-container">
            <h4>Årlig Utveckling</h4>
            <table id="hpc-projection-table">
                <thead>
                    <tr>
                        <th>År</th>
                        <th>Husets Värde</th>
                        <th>Kvarvarande Skuld</th>
                        <th>Årlig Amortering</th>
                        <th>Nettoförmögenhet i Boendet</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data fylls i av JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
</div>
